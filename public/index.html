<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simply Art Gallery</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.2.0/mdb.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body>      
  <nav class="navbar">
    <div class="nav-left">
      <span class="logo">SimplyArt</span>
      <a href="index.html" class="nav-link active">Home</a>
      <a href="about.html" class="nav-link">About This Page</a>
      <a href="#" class="nav-link">Browse</a>
      <a href="#" class="nav-link">My Collection</a>
    </div>
    <div class="nav-right">
      <a href="#" class="nav-link">Help</a>
      <a href="#" class="cart-icon">
        üõçÔ∏è <span class="cart-total">0 items</span>
      </a>
    </div>
  </nav>

  <!-- Hero Header -->
  <header class="hero">
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <h1>DISCOVER THE WORLD OF ART</h1>
      <p>Explore, add, and manage curated artwork collections</p>
      <div class="search-wrapper">
        <input type="text" id="searchInput" placeholder="Enter keywords..." />
        <button onclick="searchArtworks()" class="search-button" aria-label="Search">
          <i class="fas fa-search"></i>
        </button>
      </div>      
    </div>
  </header>

  <!-- Toggle Form Button -->
  <div class="fab-container">
    <button class="fab" onclick="toggleForm()">‚ûï</button>
  </div>

  <!-- Hidden Form Panel -->
  <div id="form-panel" class="form-panel hidden">
    <h4>Manage Artwork</h4>
    <input id="title" class="form-control" placeholder="Title" />
    <input id="artist" class="form-control" placeholder="Artist" />
    <input id="year" class="form-control" placeholder="Year" type="number" />
    <input id="medium" class="form-control" placeholder="Medium" />
    <input id="image" class="form-control" placeholder="Image URL" />
    <input id="edit-id" type="hidden" />
    <button class="btn btn-success" onclick="addOrUpdateArtwork()">Save</button>
  </div>

  <!-- Gallery -->
  <main class="gallery-section">
    <h2 class="gallery-title">Gallery</h2>

    <div class="filter-sort-bar">
      <div class="category-filters">
        <button onclick="applyFilterSort('all')">All</button>
        <button onclick="applyFilterSort('gelatin silver photograph')">Photography</button>
        <button onclick="applyFilterSort('ink')">Ink</button>
        <button onclick="applyFilterSort('graphite')">Graphite</button>
        <button onclick="applyFilterSort('watercolor')">Watercolor</button>
      </div>
      <div class="sort-bar">
        <label for="sortSelect">Sort by:</label>
        <select id="sortSelect" onchange="applyFilterSort()">
          <option value="default">Default</option>
          <option value="year-desc">Year (Newest ‚Üí Oldest)</option>
          <option value="year-asc">Year (Oldest ‚Üí Newest)</option>
          <option value="title-asc">Title (A ‚Üí Z)</option>
          <option value="title-desc">Title (Z ‚Üí A)</option>
        </select>
      </div>
    </div>

    <div id="gallery" class="gallery-grid"></div>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.2.0/mdb.min.js"></script>
  <script>
    let currentFilter = 'all';

    function toggleForm() {
      document.getElementById("form-panel").classList.toggle("hidden");
    }

    function applyFilterSort(filterCategory = null) {
      if (filterCategory !== null) currentFilter = filterCategory;
      const sortValue = document.getElementById('sortSelect').value;

      fetch('http://localhost:3000/api/artworks')
        .then(res => res.json())
        .then(data => {
          let filtered = currentFilter === 'all'
            ? data
            : data.filter(art => art.medium?.toLowerCase().includes(currentFilter.toLowerCase()));

          switch (sortValue) {
            case 'year-desc':
              filtered.sort((a, b) => (b.year || 0) - (a.year || 0));
              break;
            case 'year-asc':
              filtered.sort((a, b) => (a.year || 0) - (b.year || 0));
              break;
            case 'title-asc':
              filtered.sort((a, b) => (a.title || '').localeCompare(b.title || ''));
              break;
            case 'title-desc':
              filtered.sort((a, b) => (b.title || '').localeCompare(a.title || ''));
              break;
          }

          renderGallery(filtered);

          document.querySelectorAll('.category-filters button').forEach(btn => btn.classList.remove('active'));
          document.querySelector(`.category-filters button[onclick*="${currentFilter}"]`)?.classList.add('active');
        });
    }

    function renderGallery(data) {
      const gallery = document.getElementById('gallery')
      gallery.innerHTML = ''
      data.forEach(art => {
        const card = document.createElement('div')
        card.className = 'card';
        card.innerHTML = `
        ${art.image ? `<img src="${art.image}" class="card-img" alt="${art.title}">` : ''}
        <div class="card-hover-overlay">
        <button class="view-details-btn" onclick='viewDetails(${JSON.stringify(art)})'>View Details</button>
        </div>
        <div class="card-body">
            <h5>${art.title || 'Untitled'}</h5>
        </div>
        `
        gallery.appendChild(card)
      })
    }

    function showDetails(art) {
    alert(
        `Title: ${art.title || 'Untitled'}\nArtist: ${art.artist || 'Unknown'}\nYear: ${art.year || 'Year Unknown'}\nMedium: ${art.medium || 'Medium Unknown'}`
    );
    }

    function viewDetails(art) {
    localStorage.setItem('selectedArtwork', JSON.stringify(art));
    window.location.href = 'details.html';
    }


    // Initial load
    window.onload = () => applyFilterSort();
  </script>
</body>
</html>
